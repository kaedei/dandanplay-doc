# API 变动日志

[[TOC]]

## 2025年1月27日

### 性能优化

近期，超出预期数量的请求使服务器过载，导致出现了多次 API 访问超时的故障。为了解决此问题，我们已优化了服务器端相关代码，并将弹幕加速服务独立拆分，应用了负载均衡与自动缩放的策略。目前开放平台服务已恢复正常。

## 2025年1月26日

### 新增功能

| 接口路径 | 参数 | 变动描述 |
|---|---|---|
| `/api/v2/search/episodes` | `tmdbId` | 增加了 `tmdbId` 参数，用于通过 TMDB ID 反查弹弹play的弹幕库。TMDB 存在 season（季）的设定而弹弹play没有，因此可能会查到多个结果。 |
| | `anime` | 改为可选参数。查询时，`anime` 和 `tmdbId` 至少需要提供一个。|

#### 示例用法

1. **使用 `tmdbId` 参数：** `/api/v2/search/episodes?tmdbId=100049&episode=2`

   直接搜索对应 TMDB ID 的动画，并过滤出指定集数的结果。

2. **同时使用 `anime` 和 `tmdbId` 参数：** `/api/v2/search/episodes?anime=可爱&tmdbId=100049&episode=2`

   先根据关键词搜索动画，再过滤出符合 TMDB ID 和集数的结果。

### 性能优化

- **优化查询响应速度：** 当 `episode` 参数为数字时，查询响应速度将得到显著提升。推荐始终使用数字来查询集数。

## 2025年1月20日

弹弹play开放平台将启用应用强制认证机制，详见[开放平台文档](README.md)。请开发者申请AppId和AppSecret，并及时更新您的应用。

预计开启强制认证的时间：**2025年1月30日**后，最晚**2025年2月5日**。

为了保证开放平台正常运行，当前，搜索接口 `/api/v2/search` 已提前开启验证（其他接口暂不受影响）。如果您的App正在使用此接口，请按照文档说明更新您的代码。
